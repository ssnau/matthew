!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){function clone(item){if(!item)return item;var result,types=[Number,String,Boolean];if(types.forEach(function(type){item instanceof type&&(result=type(item))}),"undefined"==typeof result)if("[object Array]"===Object.prototype.toString.call(item))result=[],item.forEach(function(child,index,array){result[index]=clone(child)});else if("object"==typeof item)if(item.nodeType&&"function"==typeof item.cloneNode)var result=item.cloneNode(!0);else if(item.prototype)result=item;else if(item instanceof Date)result=new Date(item);else{result={};for(var i in item)result[i]=clone(item[i])}else result=item;return result}module.exports=clone},{}],2:[function(require,module,exports){function isArray(a){return!!a&&a.indexOf&&a.slice&&a.splice}function each(array,fn){if(isArray(array))for(var i=0;i<array.length;i++)fn(array[i],i);else"object"==typeof array&&Object.keys(array).forEach(function(key){fn(array[key],key)})}module.exports=each},{}],3:[function(require,module,exports){function Node(element){this.element=element,element[NODE_INSTANCE]=this}function addEvent(evnt,elem,func){elem.addEventListener?elem.addEventListener(evnt,func,!1):elem.attachEvent?elem.attachEvent("on"+evnt,func):elem[evnt]=func}function removeEvent(event,elem,func){elem.removeEventListener?elem.addEventListener(evnt,func,!1):elem.detachEvent&&elem.attachEvent("on"+evnt,func)}function htmlEscape(unsafe){return unsafe.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function getMagicVars(expr){if(!expr)return[];if(mCache[expr])return mCache[expr];var vars=[];return(expr+"").replace(/\$\$(\w+)/g,function(match,p1){vars.push(p1)}),vars}function getOwn(obj,prop,defaultVal){return obj&&obj.hasOwnProperty(prop)?obj[prop]:defaultVal}function handleMagicVars(expr,scope,node){getMagicVars(expr).forEach(function(attName){scope["$$"+attName]=node.get(attName)})}function wrapExpr(expr,node){var ret=function(){this.$this=node,handleMagicVars(expr,this,node);var r=this.$eval(expr);return this.$this=null,r};return ret.toString=function(){return expr},ret}function isBadSymbol(val){return void 0===val||val!==val||null===val}function bindEvent(eventName,node,expr){var eventCallback=function(e){var scope=node.getScope();scope.$event=e,scope.$eval(expr),scope.$event=null,scope.$apply()};eventNormalizer[eventName]?eventNormalizer[eventName](node,eventCallback):node.on(eventName,eventCallback)}function getBinder(name){return binders[name.toLowerCase()]}function getScope(){for(var node=this;node;){if(node.hasAttribute(SCOPE_ATTR)&&!node._$scope&&createScopeOnElement(node),node._$scope)return node._$scope;node=node.ancestor()}return Scope.getRootInstance()}function createScopeOnElement(ele){var node=Y.one(ele);if(node&&!node._$scope){var isIsolate=node.getAttribute(SCOPE_ATTR)||!1,outerScope=node.ancestor()&&node.ancestor().getScope();node._$scope=isIsolate?Scope.getIsolateInstance():Scope.getInheritInstance(outerScope),isIsolate&&bindScopeAttributes(node,outerScope)}}function bindScopeAttributes(node,outerScope){var scope=node.getScope(),scopeConfig=JSON.parse(node.getAttribute(SCOPE_ATTR));outerScope&&Array.isArray(scopeConfig)&&scopeConfig.forEach(function(val){if((""+val).trim()){var pair=[val,val];val.indexOf("=")>0&&(pair=val.split("="));var attr1=pair[0],attr2=pair[1];scope[attr1]=outerScope[attr2],outerScope.$watch(attr2,function(value){scope.$set(attr1,value)})}})}function traverse(root,callback){function dfs(node){if(callback(node)!==!1){var children=node.get("children");children&&children.each(function(ndChild){dfs(ndChild)})}}dfs(root)}var Scope=require("./scope"),Validator=require("./validator"),parser=require("./ng-parse"),each=require("./each"),SCOPE_ATTR="m-scope",NODE_INSTANCE="__M_NODE_INSTANCE",eachId=0,mCache={},isEventSupported=function(){function isEventSupported(eventName){var el=document.createElement(TAGNAMES[eventName]||"div");eventName="on"+eventName;var isSupported=eventName in el;return isSupported||(el.setAttribute(eventName,"return;"),isSupported="function"==typeof el[eventName]),el=null,isSupported}var TAGNAMES={select:"input",change:"input",input:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return isEventSupported}();Node.addMethod=function(name,method){Node.prototype[name]=method},Node.create=function(str){var div=document.createElement("div");return div.innerHTML=str,new Node(div.firstChild)},Node.isNode=function(node){return node instanceof Node},each({set:function(name,val){"value"!=name&&"checked"!=name&&"className"!=name||(this.element[name]=val),this.setAttribute(name,val)},get:function(name){if("value"==name||"checked"==name||"className"==name)return this.element[name];var ret=this.element[name]||this.getAttribute(name);return"children"==name&&ret?Y.all(ret):ret},on:function(name,callback){var elem=this.element,events=(!!elem.attachEvent,[]);switch(name){case"valuechange":events=isEventSupported("input")?["input","paste"]:["keyup","paste"];break;default:events=[name]}return each(events,function(event){addEvent(event,elem,callback)}),function(){each(events,function(event){removeEvent(event,elem,callback)})}},next:function(){return Y.one(this.element.nextElementSibling||this.element.nextSibling)},contains:function(node){for(var elem=Y.one(node).element,target=this.element;elem;){if(elem==target)return!0;elem=elem.parentNode}return!1},addClass:function(name){var n=this.element,classes=n.className.split(/\s+/).filter(Boolean);classes.some(function(c){})||(n.className=classes.concat(name).join(" "))},removeClass:function(name){var n=this.element,classes=n.className.split(/\s+/);n.className=classes.filter(function(x){}).join(" ")},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"},hasAttribute:function(name){return this.element.hasAttribute&&this.element.hasAttribute(name)},getAttribute:function(name){return this.element.getAttribute&&this.element.getAttribute(name)},setAttribute:function(name,val){return this.element.setAttribute(name,val)},removeAttribute:function(name){return this.element.removeAttribute(name)},remove:function(){return this.element.remove()},ancestor:function(tagName){var ele=this.element;if(!tagName)return Y.one(ele.parentNode);for(;;){if(!ele)return;if("tagName"==ele.tagName)return Y.one(ele);ele=ele.parentNode}},insert:function(node,pos){var thisEle=this.element,nodeEle=node.element||node;return"after"==pos?thisEle.parentNode.insertBefore(nodeEle,thisEle.nextSibling):thisEle.insertBefore(node)},setHTML:function(str){this.element.innerHTML=str},getDOMNode:function(){return this.element}},function(val,key){Node.addMethod(key,val)});var Y={one:function(element){if(element)return element.element&&element.getDOMNode?element:element[NODE_INSTANCE]?element[NODE_INSTANCE]:new Node(element)},all:function(array){for(var arr=[],i=0;i<array.length;i++)arr.push(new Node(array[i]));return arr.each=arr.forEach,arr}},ie=function(){try{for(var undef,v=3,div=document.createElement("div"),all=div.getElementsByTagName("i");div.innerHTML="<!--[if gt IE "+ ++v+"]><i></i><![endif]-->",all[0];);return v>4?v:undef}catch(e){return 0}}(),binders={"m-init":function(node,scope,expr){scope.$eval(expr)},"m-html":function(node,scope,expr){scope.$watch(expr,function(val){var v=isBadSymbol(val)?"":val;node.setHTML(htmlEscape(v+""))})},"m-unsafe-html":function(node,scope,expr){scope.$watch(expr,function(val){node.setHTML(val)})},"m-show":function(node,scope,expr){scope.$watch(expr,function(val){node[val?"show":"hide"]()})},"m-disabled":function(node,scope,expr){scope.$watch(expr,function(val){node.set("disabled",!!val)})},"m-class":function(node,scope,expr){scope.$watch(expr,function(val){node.set("className",Object.keys(val||{}).filter(function(key){return val[key]}).join(" "))})},"m-value":function(node,scope,expr){scope.$watch(function(){var val=scope.$eval(expr);if(String(node.get("value"))!==String(val)&&node.set("value",isBadSymbol(val)?"":val),ie>0&&"SELECT"===node.get("tagName"))for(var selectElem=node.getDOMNode(),options=selectElem.options,i=0;i<options.length;i++)String(options[i].value)===String(val)&&(selectElem.selectedIndex=i)})},"m-checked":function(node,scope,expr){scope.$watch(function(){var val=scope.$eval(expr);node.get("checked")!==val&&node.set("checked",val)})},"m-defaultvalue":function(node,scope,expr){var unwatch=scope.$watch(expr,function(val){isBadSymbol(val)||(node.set("value",val),unwatch())})},"m-attr":function(node,scope,expr){scope.$watch(expr,function(val){each(val,function(val,key){node.setAttribute(key,val)})})},"m-repeat":function(node,scope){function strip(str){return str.trim().replace(/^\(|\)$/,"").trim()}function TempLocal(){}var expression,keyName,valName,trackExp,origExp=node.getAttribute("m-repeat")||node.getAttribute("m-repeat"),match=origExp.match(/(.*) in (.*) (track by (.*))/)||origExp.match(/(.*) in (.*)/);if(!match)throw new Error(origExp+" is not a valid m-repeat statement. please follow [val in attr]/ [(key, val) in attr] convention.");var pair=match[1].split(",");expression=match[2],keyName=strip(pair.length>1?pair[0]:"__"),valName=strip(pair.length>1?pair[1]:pair[0]),trackExp=match[4]||"$index";var id=++eachId,tmplId="data-m-template-"+id;node.removeAttribute("m-repeat"),node.removeAttribute("m-repeat"),node.setAttribute("data-m-id",id);var html=node.get("outerHTML"),templateNode=Node.create('<script type="text/x-m-repeat-template" id="$id">/* expression: $expr */\n$html</script>'.replace("$id",tmplId).replace("$html",html).replace("$expr",origExp));node.insert(templateNode,"after"),node.remove();var idMap={};TempLocal.prototype=scope;var trackFn=parser.parse(trackExp),getId=function(val,index){var local=new TempLocal;return local[valName]=val,local.$index=index,trackFn(local)};return scope.$watch(expression,function(array){var toBeDeleteIds=[],newMap={};each(array,function(val,index){newMap[getId(val,index)]=val}),each(idMap,function(val,key){newMap.hasOwnProperty(key)||toBeDeleteIds.push(key)}),each(toBeDeleteIds,function(key){idMap[key].scope.$destory(),idMap[key].node.remove(!0),delete idMap[key]});var count=0,len=Array.isArray(array)?array.length:Object.keys(array||{}).length,baseNode=templateNode;each(array,function(val,key){var childScope,node,trackId=getId(val,key);idMap[trackId]?(childScope=idMap[trackId].scope,node=idMap[trackId].node):(childScope=Scope.getInheritInstance(scope),node=Node.create(html)),idMap[trackId]={scope:childScope,node:node},childScope[valName]=val,childScope[keyName]=key,childScope.$set({$index:key,$first:0===count,$last:count===len-1,$middle:count>0&&count<len-1,$even:count%2===0,$odd:count%2!==0}),matthew.init(node,childScope),baseNode.next()!==node&&baseNode.insert(node,"after"),baseNode=node,count++})}),!1},"m-validate":function(node,scope,expr){var config=scope.$eval(expr),validation=config.validation;if(!validation)throw new Error("The m-validate config should contain validation field");var validate=function(){if(!Y.one(document.body).contains(node))return!0;if(node.get("disabled"))return!0;scope.$this=node;var valid=node.scopeEval(validation);return scope.$this=null,node.removeClass("m-validate-valid"),node.removeClass("m-validate-invalid"),node.addClass(valid===!0||valid&&valid.value===!0?"m-validate-valid":"m-validate-invalid"),scope.$apply(),valid};scope.$watch(getOwn(config,"watch"),validate,!0);var ndForm=node.ancestor("form");ndForm&&Validator.getInstance(ndForm).register(config.group,validate),(getOwn(config,"event")||getOwn(config,"events")||"").split("|").map(function(eventName){return eventName.trim().replace(/^on/,"")}).forEach(function(eventName){bindEvent(eventName,node,validate)})},"m-model":function(node,scope,modelName){function equal(a,b){return String(a)===String(b)}function contains(arr,val){return!!arr.filter(function(v){return equal(v,val)}).length}var strategies={"input#radio":function(node,val){node.set("checked",equal(node.get("value"),val))},"input#checkbox":function(node,val){node.set("checked",Array.isArray(val)?contains(val,node.get("value")):equal(val,node.get("value")))},"select#select-one":function(node,val){node.set("value",val)},"select#select-multiple":function(node,val){var options=node.get("options");Y.all(options).each(function(ndOption){ndOption.set("selected",contains(val,ndOption.get("value"),val))})},default:function(node,val){equal(node.get("value"),val)||node.set("value",val)}};scope.$watch(modelName,function(val){var strategy=strategies[(node.get("tagName")+"#"+node.get("type")).toLowerCase()]||strategies.default;strategy(node,val)})}},priorites={"m-repeat":999,"*":100},eventNormalizer={change:function(node,callback){var eventname="change";return/checkbox|radio/.test(node.get("type"))&&ie>0&&ie<9?void node.on("propertychange",function(e){"checked"===e._event.propertyName&&callback(e)}):("text"!==node.get("type")&&"password"!==node.get("type")&&"TEXTAREA"!==node.get("tagName")||(eventname="valuechange"),void node.on(eventname,callback))}},matthew={init:function(ele,scope){var root=Y.one(ele);if(root){scope&&(root._$scope=scope);var PAT_BIND_EVENT_ATTR1=/^m-on\w+/;traverse(root,function(node){if(node.hasAttribute(SCOPE_ATTR)&&createScopeOnElement(node),!node._$binded){node._$binded=!0;var attributes=node.getDOMNode().attributes;if(attributes){for(var bindAttrs=[],i=0;i<attributes.length;i++){var attr=attributes[i],attrName=attr.name;getBinder(attrName)?bindAttrs.push({name:attrName,priority:priorites[attrName]||priorites["*"]}):PAT_BIND_EVENT_ATTR1.test(attrName)&&bindAttrs.push({name:attrName,priority:priorites["*"]})}bindAttrs.sort(function(a,b){return b.priority-a.priority});var stop=!1;bindAttrs.forEach(function(attr){if(!stop){var attrName=attr.name,expr=wrapExpr(node.getAttribute(attrName),node);if(getBinder(attrName))return void(stop=getBinder(attrName)(node,node.getScope(),expr)===!1);var eventName=attrName.slice("m-on".length);bindEvent(eventName,node,expr)}})}}})}},register:function(name,callback,config){name=name.toLowerCase(),binders[name]=callback,config=config||{},priorites[name]=config.priority||priorites["*"]},getScope:function(element){return Y.one(element||document.body).getScope()},Y:Y};Node.addMethod("getScope",getScope),Node.addMethod("scope",getScope),Node.addMethod("scopeEval",function(expr){return this.getScope().$eval(wrapExpr(expr,this))}),"undefine"!=typeof window&&(window.matthew=matthew),!function(){var scripts=document.getElementsByTagName("script"),me=scripts[scripts.length-1];setTimeout(function(){me.getAttribute("auto-init")&&matthew.init(document.body)})}(),setTimeout(function(){Y.one(document.body)._$scope=Scope.getRootInstance()}),module.exports=matthew},{"./each":2,"./ng-parse":4,"./scope":5,"./validator":6}],4:[function(require,module,exports){function noop(){}function toJson(obj,pretty){if("undefined"!=typeof obj)return JSON.stringify(obj,toJsonReplacer,pretty?"  ":null)}function toJsonReplacer(key,value){var val=value;return"string"==typeof key&&"$"===key.charAt(0)&&"$"===key.charAt(1)?val=void 0:isWindow(value)?val="$WINDOW":value&&document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function minErr(module,ErrorConstructor){return ErrorConstructor=ErrorConstructor||Error,function(){var message,code=arguments[0],prefix="["+(module?module+":":"")+code+"] ",template=arguments[1],templateArgs=arguments;return message=prefix+template.replace(/\{\d+\}/g,function(match){var arg,index=+match.slice(1,-1);return index+2<templateArgs.length?(arg=templateArgs[index+2],"function"==typeof arg?arg.toString().replace(/ ?\{[\s\S]*$/,""):"undefined"==typeof arg?"undefined":"string"!=typeof arg?toJson(arg):arg):match}),new ErrorConstructor(message)}}function extend(dst){for(var i=1,ii=arguments.length;i<ii;i++){var obj=arguments[i];if(obj)for(var keys=Object.keys(obj),j=0,jj=keys.length;j<jj;j++){var key=keys[j];dst[key]=obj[key]}}return dst}function forEach(obj,iterator,context){var key,length;if(obj)if(isFunction(obj))for(key in obj)"prototype"==key||"length"==key||"name"==key||obj.hasOwnProperty&&!obj.hasOwnProperty(key)||iterator.call(context,obj[key],key,obj);else if(isArray(obj)||isArrayLike(obj)){var isPrimitive="object"!=typeof obj;for(key=0,length=obj.length;key<length;key++)(isPrimitive||key in obj)&&iterator.call(context,obj[key],key,obj)}else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context,obj);else for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key,obj);return obj}function valueFn(value){return function(){return value}}function isDefined(value){return"undefined"!=typeof value}function isString(value){return"string"==typeof value}function isFunction(value){return"function"==typeof value}function isWindow(obj){return obj&&obj.window===obj}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isArrayLike(obj){if(null==obj||isWindow(obj))return!1;var length=obj.length;return!(obj.nodeType!==NODE_TYPE_ELEMENT||!length)||(isString(obj)||isArray(obj)||0===length||"number"==typeof length&&length>0&&length-1 in obj)}function createMap(){return{}}function ensureSafeMemberName(name,fullExpression){if("__defineGetter__"===name||"__defineSetter__"===name||"__lookupGetter__"===name||"__lookupSetter__"===name||"__proto__"===name)throw $parseMinErr("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",fullExpression);return name}function ensureSafeObject(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.window===obj)throw $parseMinErr("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.children&&(obj.nodeName||obj.prop&&obj.attr&&obj.find))throw $parseMinErr("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===Object)throw $parseMinErr("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",fullExpression)}return obj}function ensureSafeFunction(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===CALL||obj===APPLY||obj===BIND)throw $parseMinErr("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",fullExpression)}}function isConstant(exp){return exp.constant}function setter(obj,path,setValue,fullExp){ensureSafeObject(obj,fullExp);for(var key,element=path.split("."),i=0;element.length>1;i++){key=ensureSafeMemberName(element.shift(),fullExp);var propertyObj=ensureSafeObject(obj[key],fullExp);propertyObj||(propertyObj={},obj[key]=propertyObj),obj=propertyObj}return key=ensureSafeMemberName(element.shift(),fullExp),ensureSafeObject(obj[key],fullExp),obj[key]=setValue,setValue}function isPossiblyDangerousMemberName(name){return"constructor"==name}function identity($){return $}function cspSafeGetterFn(key0,key1,key2,key3,key4,fullExp,expensiveChecks){ensureSafeMemberName(key0,fullExp),ensureSafeMemberName(key1,fullExp),ensureSafeMemberName(key2,fullExp),ensureSafeMemberName(key3,fullExp),ensureSafeMemberName(key4,fullExp);var eso=function(o){return ensureSafeObject(o,fullExp)},eso0=expensiveChecks||isPossiblyDangerousMemberName(key0)?eso:identity,eso1=expensiveChecks||isPossiblyDangerousMemberName(key1)?eso:identity,eso2=expensiveChecks||isPossiblyDangerousMemberName(key2)?eso:identity,eso3=expensiveChecks||isPossiblyDangerousMemberName(key3)?eso:identity,eso4=expensiveChecks||isPossiblyDangerousMemberName(key4)?eso:identity;return function(scope,locals){var pathVal=locals&&locals.hasOwnProperty(key0)?locals:scope;if(null==pathVal)return pathVal;if(pathVal=eso0(pathVal[key0]),!key1)return pathVal;if(null!=pathVal){if(pathVal=eso1(pathVal[key1]),!key2)return pathVal;if(null!=pathVal){if(pathVal=eso2(pathVal[key2]),!key3)return pathVal;if(null!=pathVal){if(pathVal=eso3(pathVal[key3]),!key4)return pathVal;if(null!=pathVal)return pathVal=eso4(pathVal[key4])}}}}}function getterFnWithEnsureSafeObject(fn,fullExpression){return function(s,l){return fn(s,l,ensureSafeObject,fullExpression)}}function getterFn(path,options,fullExp){var expensiveChecks=options.expensiveChecks,getterFnCache=expensiveChecks?getterFnCacheExpensive:getterFnCacheDefault,fn=getterFnCache[path];if(fn)return fn;var pathKeys=path.split("."),pathKeysLength=pathKeys.length;if(options.csp)fn=pathKeysLength<6?cspSafeGetterFn(pathKeys[0],pathKeys[1],pathKeys[2],pathKeys[3],pathKeys[4],fullExp,expensiveChecks):function(scope,locals){var val,i=0;do val=cspSafeGetterFn(pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],fullExp,expensiveChecks)(scope,locals),locals=void 0,scope=val;while(i<pathKeysLength);return val};else{var code="";expensiveChecks&&(code+="s = eso(s, fe);\nl = eso(l, fe);\n");var needsEnsureSafeObject=expensiveChecks;forEach(pathKeys,function(key,index){ensureSafeMemberName(key,fullExp);var lookupJs=(index?"s":'((l&&l.hasOwnProperty("'+key+'"))?l:s)')+('["'+key+'"]');(expensiveChecks||isPossiblyDangerousMemberName(key))&&(lookupJs="eso("+lookupJs+", fe)",needsEnsureSafeObject=!0),code+="if(s == null) return undefined;\ns="+lookupJs+";\n"}),code+="return s;";var evaledFnGetter=new Function("s","l","eso","fe",code);evaledFnGetter.toString=valueFn(code),needsEnsureSafeObject&&(evaledFnGetter=getterFnWithEnsureSafeObject(evaledFnGetter,fullExp)),fn=evaledFnGetter}return fn.sharedGetter=!0,fn.assign=function(self,value){return setter(self,path,value,path)},getterFnCache[path]=fn,fn}var NODE_TYPE_ELEMENT=1,lowercase=function(string){return isString(string)?string.toLowerCase():string},uppercase=(Object.prototype.hasOwnProperty,Object.prototype.toString,function(string){return isString(string)?string.toUpperCase():string}),manualLowercase=function(s){return isString(s)?s.replace(/[A-Z]/g,function(ch){return String.fromCharCode(32|ch.charCodeAt(0))}):s},manualUppercase=function(s){return isString(s)?s.replace(/[a-z]/g,function(ch){return String.fromCharCode(ch.charCodeAt(0)&-33)}):s};"i"!=="I".toLowerCase()&&(lowercase=manualLowercase,uppercase=manualUppercase);var $parseMinErr=minErr("$parse"),isArray=Array.isArray,CALL=Function.prototype.call,APPLY=Function.prototype.apply,BIND=Function.prototype.bind,CONSTANTS=createMap();forEach({null:function(){return null},true:function(){return!0},false:function(){return!1},undefined:function(){}},function(constantGetter,name){constantGetter.constant=constantGetter.literal=constantGetter.sharedGetter=!0,CONSTANTS[name]=constantGetter}),CONSTANTS.this=function(self){return self},CONSTANTS.this.sharedGetter=!0;var OPERATORS=extend(createMap(),{"+":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),isDefined(a)?isDefined(b)?a+b:a:isDefined(b)?b:void 0},"-":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),(isDefined(a)?a:0)-(isDefined(b)?b:0)},"*":function(self,locals,a,b){return a(self,locals)*b(self,locals)},"/":function(self,locals,a,b){return a(self,locals)/b(self,locals)},"%":function(self,locals,a,b){return a(self,locals)%b(self,locals)},"===":function(self,locals,a,b){return a(self,locals)===b(self,locals)},"!==":function(self,locals,a,b){return a(self,locals)!==b(self,locals)},"==":function(self,locals,a,b){return a(self,locals)==b(self,locals)},"!=":function(self,locals,a,b){return a(self,locals)!=b(self,locals)},"<":function(self,locals,a,b){return a(self,locals)<b(self,locals)},">":function(self,locals,a,b){return a(self,locals)>b(self,locals)},"<=":function(self,locals,a,b){return a(self,locals)<=b(self,locals)},">=":function(self,locals,a,b){return a(self,locals)>=b(self,locals)},"&&":function(self,locals,a,b){return a(self,locals)&&b(self,locals)},"||":function(self,locals,a,b){return a(self,locals)||b(self,locals)},"!":function(self,locals,a){return!a(self,locals)},"=":!0,"|":!0}),ESCAPE={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},Lexer=function(options){this.options=options};Lexer.prototype={constructor:Lexer,lex:function(text){for(this.text=text,this.index=0,this.ch=void 0,this.tokens=[];this.index<this.text.length;)if(this.ch=this.text.charAt(this.index),this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent();else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch}),this.index++;else if(this.isWhitespace(this.ch))this.index++;else{var ch2=this.ch+this.peek(),ch3=ch2+this.peek(2),fn=OPERATORS[this.ch],fn2=OPERATORS[ch2],fn3=OPERATORS[ch3];fn3?(this.tokens.push({index:this.index,text:ch3,fn:fn3}),this.index+=3):fn2?(this.tokens.push({index:this.index,text:ch2,fn:fn2}),this.index+=2):fn?(this.tokens.push({index:this.index,text:this.ch,fn:fn}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}return this.tokens},is:function(chars){return chars.indexOf(this.ch)!==-1},peek:function(i){var num=i||1;return this.index+num<this.text.length&&this.text.charAt(this.index+num)},isNumber:function(ch){return"0"<=ch&&ch<="9"},isWhitespace:function(ch){return" "===ch||"\r"===ch||"\t"===ch||"\n"===ch||"\v"===ch||" "===ch},isIdent:function(ch){return"a"<=ch&&ch<="z"||"A"<=ch&&ch<="Z"||"_"===ch||"$"===ch},isExpOperator:function(ch){return"-"===ch||"+"===ch||this.isNumber(ch)},throwError:function(error,start,end){end=end||this.index;var colStr=isDefined(start)?"s "+start+"-"+this.index+" ["+this.text.substring(start,end)+"]":" "+end;throw $parseMinErr("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",error,colStr,this.text)},readNumber:function(){for(var number="",start=this.index;this.index<this.text.length;){var ch=lowercase(this.text.charAt(this.index));if("."==ch||this.isNumber(ch))number+=ch;else{var peekCh=this.peek();if("e"==ch&&this.isExpOperator(peekCh))number+=ch;else if(this.isExpOperator(ch)&&peekCh&&this.isNumber(peekCh)&&"e"==number.charAt(number.length-1))number+=ch;else{if(!this.isExpOperator(ch)||peekCh&&this.isNumber(peekCh)||"e"!=number.charAt(number.length-1))break;this.throwError("Invalid exponent")}}this.index++}number*=1,this.tokens.push({index:start,text:number,constant:!0,fn:function(){return number}})},readIdent:function(){for(var lastDot,peekIndex,methodName,ch,expression=this.text,ident="",start=this.index;this.index<this.text.length&&(ch=this.text.charAt(this.index),"."===ch||this.isIdent(ch)||this.isNumber(ch));)"."===ch&&(lastDot=this.index),ident+=ch,this.index++;if(lastDot&&"."===ident[ident.length-1]&&(this.index--,ident=ident.slice(0,-1),lastDot=ident.lastIndexOf("."),lastDot===-1&&(lastDot=void 0)),lastDot)for(peekIndex=this.index;peekIndex<this.text.length;){if(ch=this.text.charAt(peekIndex),"("===ch){methodName=ident.substr(lastDot-start+1),ident=ident.substr(0,lastDot-start),this.index=peekIndex;break}if(!this.isWhitespace(ch))break;peekIndex++}this.tokens.push({index:start,text:ident,fn:CONSTANTS[ident]||getterFn(ident,this.options,expression)}),methodName&&(this.tokens.push({index:lastDot,text:"."}),this.tokens.push({index:lastDot+1,text:methodName}))},readString:function(quote){var start=this.index;this.index++;for(var string="",rawString=quote,escape=!1;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(rawString+=ch,escape){if("u"===ch){var hex=this.text.substring(this.index+1,this.index+5);hex.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+hex+"]"),this.index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{var rep=ESCAPE[ch];string+=rep||ch}escape=!1}else if("\\"===ch)escape=!0;else{if(ch===quote)return this.index++,void this.tokens.push({index:start,text:rawString,string:string,constant:!0,fn:function(){return string}});string+=ch}this.index++}this.throwError("Unterminated quote",start)}};var Parser=function(lexer,$filter,options){this.lexer=lexer,this.$filter=$filter,this.options=options};Parser.ZERO=extend(function(){return 0},{sharedGetter:!0,constant:!0}),Parser.prototype={constructor:Parser,parse:function(text){this.text=text,this.tokens=this.lexer.lex(text);var value=this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),value.literal=!!value.literal,value.constant=!!value.constant,value},primary:function(){var primary;if(this.expect("("))primary=this.filterChain(),this.consume(")");else if(this.expect("["))primary=this.arrayDeclaration();else if(this.expect("{"))primary=this.object();else{var token=this.expect();primary=token.fn,primary||this.throwError("not a primary expression",token),token.constant&&(primary.constant=!0,primary.literal=!0)}for(var next,context;next=this.expect("(","[",".");)"("===next.text?(primary=this.functionCall(primary,context),context=null):"["===next.text?(context=primary,primary=this.objectIndex(primary)):"."===next.text?(context=primary,primary=this.fieldAccess(primary)):this.throwError("IMPOSSIBLE");return primary},throwError:function(msg,token){throw $parseMinErr("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",token.text,msg,token.index+1,this.text,this.text.substring(token.index))},peekToken:function(){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e1,e2,e3,e4){if(this.tokens.length>0){var token=this.tokens[0],t=token.text;if(t===e1||t===e2||t===e3||t===e4||!e1&&!e2&&!e3&&!e4)return token}return!1},expect:function(e1,e2,e3,e4){var token=this.peek(e1,e2,e3,e4);return!!token&&(this.tokens.shift(),token)},consume:function(e1){this.expect(e1)||this.throwError("is unexpected, expecting ["+e1+"]",this.peek())},unaryFn:function(fn,right){return extend(function(self,locals){return fn(self,locals,right)},{constant:right.constant,inputs:[right]})},binaryFn:function(left,fn,right,isBranching){return extend(function(self,locals){return fn(self,locals,left,right)},{constant:left.constant&&right.constant,inputs:!isBranching&&[left,right]})},statements:function(){for(var statements=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&statements.push(this.filterChain()),!this.expect(";"))return 1===statements.length?statements[0]:function(self,locals){for(var value,i=0,ii=statements.length;i<ii;i++)value=statements[i](self,locals);return value}},filterChain:function(){for(var token,left=this.expression();token=this.expect("|");)left=this.filter(left);return left},filter:function(inputFn){var argsFn,args,token=this.expect(),fn=this.$filter(token.text);if(this.peek(":"))for(argsFn=[],args=[];this.expect(":");)argsFn.push(this.expression());var inputs=[inputFn].concat(argsFn||[]);return extend(function(self,locals){var input=inputFn(self,locals);if(args){args[0]=input;for(var i=argsFn.length;i--;)args[i+1]=argsFn[i](self,locals);return fn.apply(void 0,args)}return fn(input)},{constant:!fn.$stateful&&inputs.every(isConstant),inputs:!fn.$stateful&&inputs})},expression:function(){return this.assignment()},assignment:function(){var right,token,left=this.ternary();return(token=this.expect("="))?(left.assign||this.throwError("implies assignment but ["+this.text.substring(0,token.index)+"] can not be assigned to",token),right=this.ternary(),extend(function(scope,locals){return left.assign(scope,right(scope,locals),locals)},{inputs:[left,right]})):left},ternary:function(){var middle,token,left=this.logicalOR();
if(token=this.expect("?")){if(middle=this.assignment(),token=this.expect(":")){var right=this.assignment();return extend(function(self,locals){return left(self,locals)?middle(self,locals):right(self,locals)},{constant:left.constant&&middle.constant&&right.constant})}this.throwError("expected :",token)}return left},logicalOR:function(){for(var token,left=this.logicalAND();token=this.expect("||");)left=this.binaryFn(left,token.fn,this.logicalAND(),!0);return left},logicalAND:function(){var token,left=this.equality();return(token=this.expect("&&"))&&(left=this.binaryFn(left,token.fn,this.logicalAND(),!0)),left},equality:function(){var token,left=this.relational();return(token=this.expect("==","!=","===","!=="))&&(left=this.binaryFn(left,token.fn,this.equality())),left},relational:function(){var token,left=this.additive();return(token=this.expect("<",">","<=",">="))&&(left=this.binaryFn(left,token.fn,this.relational())),left},additive:function(){for(var token,left=this.multiplicative();token=this.expect("+","-");)left=this.binaryFn(left,token.fn,this.multiplicative());return left},multiplicative:function(){for(var token,left=this.unary();token=this.expect("*","/","%");)left=this.binaryFn(left,token.fn,this.unary());return left},unary:function(){var token;return this.expect("+")?this.primary():(token=this.expect("-"))?this.binaryFn(Parser.ZERO,token.fn,this.unary()):(token=this.expect("!"))?this.unaryFn(token.fn,this.unary()):this.primary()},fieldAccess:function(object){var expression=this.text,field=this.expect().text,getter=getterFn(field,this.options,expression);return extend(function(scope,locals,self){return getter(self||object(scope,locals))},{assign:function(scope,value,locals){var o=object(scope,locals);return o||object.assign(scope,o={}),setter(o,field,value,expression)}})},objectIndex:function(obj){var expression=this.text,indexFn=this.expression();return this.consume("]"),extend(function(self,locals){var v,o=obj(self,locals),i=indexFn(self,locals);if(ensureSafeMemberName(i,expression),o)return v=ensureSafeObject(o[i],expression)},{assign:function(self,value,locals){var key=ensureSafeMemberName(indexFn(self,locals),expression),o=ensureSafeObject(obj(self,locals),expression);return o||obj.assign(self,o={}),o[key]=value}})},functionCall:function(fnGetter,contextGetter){var argsFn=[];if(")"!==this.peekToken().text)do argsFn.push(this.expression());while(this.expect(","));this.consume(")");var expressionText=this.text,args=[];return function(scope,locals){var context=contextGetter?contextGetter(scope,locals):scope,fn=fnGetter(scope,locals,context)||noop;if(args)for(var i=argsFn.length;i--;)args[i]=ensureSafeObject(argsFn[i](scope,locals),expressionText);ensureSafeObject(context,expressionText),ensureSafeFunction(fn,expressionText);var v=fn.apply?fn.apply(context,args):fn(args[0],args[1],args[2],args[3],args[4]);return ensureSafeObject(v,expressionText)}},arrayDeclaration:function(){var elementFns=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;var elementFn=this.expression();elementFns.push(elementFn)}while(this.expect(","));return this.consume("]"),extend(function(self,locals){for(var array=[],i=0,ii=elementFns.length;i<ii;i++)array.push(elementFns[i](self,locals));return array},{literal:!0,constant:elementFns.every(isConstant),inputs:elementFns})},object:function(){var keys=[],valueFns=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var token=this.expect();keys.push(token.string||token.text),this.consume(":");var value=this.expression();valueFns.push(value)}while(this.expect(","));return this.consume("}"),extend(function(self,locals){for(var object={},i=0,ii=valueFns.length;i<ii;i++)object[keys[i]]=valueFns[i](self,locals);return object},{literal:!0,constant:valueFns.every(isConstant),inputs:valueFns})}};var getterFnCacheDefault=createMap(),getterFnCacheExpensive=createMap();Object.prototype.valueOf;module.exports=new Parser(new Lexer({}),{},{})},{}],5:[function(require,module,exports){function parse(string){return parserCache[string]||(parserCache[string]=parser.parse(string)),parserCache[string]}function checkLog(){return!(!ENABLE_LOG&&!win.ENABLE_SCOPE_LOG)}function log(){checkLog()&&console.log&&console.log.apply(console,arguments)}function dir(){checkLog()&&console.dir&&console.dir.apply(console,arguments)}function isWindow(obj){return obj&&obj.document&&obj.location&&obj.alert&&obj.setInterval}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!==o1&&o2!==o2)return!0;var length,key,keySet,t1=typeof o1,t2=typeof o2;if(t1==t2&&"object"==t1){if(!isArray(o1)){if(isDate(o1))return isDate(o2)&&o1.getTime()==o2.getTime();if(isRegExp(o1)&&isRegExp(o2))return o1.toString()==o2.toString();if(isWindow(o1)||isWindow(o2)||isArray(o2))return!1;keySet={};for(key in o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!keySet.hasOwnProperty(key)&&"$"!==key.charAt(0)&&void 0!==o2[key]&&!isFunction(o2[key]))return!1;return!0}if(!isArray(o2))return!1;if((length=o1.length)==o2.length){for(key=0;key<length;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}function Scope(){this._$$watched=[],this._$$children=[],this._$id=++instanceCount,Scope._instances[this._$id]=this}var win="undefined"!=typeof window?window:{},console=win.console||{},parser=require("./ng-parse"),clone=require("./clone"),each=require("./each"),noop=function(){},isArray=function(a){return!!a&&a.indexOf&&a.slice&&a.splice},isDate=function(a){return a&&"function"==typeof a.getTime&&"function"==typeof a.getDate},isRegExp=function(a){return a instanceof RegExp},isFunction=function(a){return"function"==typeof a},ENABLE_LOG=!1,instanceCount=0,watchId=1,parserCache={};Scope.TTL=10,Scope.DELAY=10,Scope._instances={};var rootScope;Scope.getRootInstance=function(){return rootScope&&!rootScope._$destoried?rootScope:rootScope=new Scope},Scope.getIsolateInstance=function(){return new Scope},Scope.getInheritInstance=function(parent){function ChildScope(){}ChildScope.prototype=parent;var scope=new ChildScope;return Scope.apply(scope),parent._$$children.push(scope),scope.$parent=parent,scope},Scope.getInstance=function(){return this.getRootInstance()},Scope.digest=function(force){Scope.getRootInstance()[force?"$digest":"$digestIfPending"]()},Scope.prototype={constructor:Scope,_$digestAsync:function(){var me=this;Scope._handler||(Scope._handler=setTimeout(function(){me.$digest()},Scope.DELAY))},_clearHanlder:function(){clearTimeout(Scope._handler),Scope._handler=null},_$collectWatchers:function(){var watchers=[];return each(Scope._instances,function(instance){watchers=watchers.concat(instance._$$watched)}),watchers},$digest:function(){log("-----[digesting]------");for(var count=0;;){this._clearHanlder();var watchers=this._$collectWatchers();if(count++,count>Scope.TTL){log("[digesting] digest max loop ["+Scope.TTL+"]reached, give up");break}var invokeList=[],dirty=!1;if(log("[digesting] round #"+count),each(watchers,function(watcher){var oldValue=watcher.value,newValue=watcher.func();equals(oldValue,newValue)||(watcher.value=clone(newValue,!0),dirty=!0,invokeList.push({func:watcher.callback,args:[watcher.value,oldValue]}))}),log("[digesting] "+invokeList.length+" callbacks in queue."),invokeList.length&&log("they are:"),each(invokeList,function(invoker){dir(invoker);try{invoker.func.apply(null,invoker.args||[])}catch(e){log("error when invoke:"),dir(invoker)}}),!dirty){log("[digesting] data is stable, stop digesting"),this._clearHanlder();break}log("[digesting] data is dirty, start next digest")}},$digestIfPending:function(){Scope._handler&&this.$digest()},$destory:function(){delete Scope._instances[this._$id],this._$$watched=[],this._$destoried=!0},$set:function(name,value){var me=this;return name instanceof Object?each(name,function(val,key){me[key]=val}):void(name&&(me[name]=value,this._$digestAsync()))},$apply:function(){this._$digestAsync()},$eval:function(expression){return isFunction(expression)?expression.call(this):parse(expression)(this)},$default:function(hash){var scope=this;Object.keys(hash).forEach(function(key){scope[key]=scope.hasOwnProperty(key)?scope[key]:hash[key]})},$watch:function(expression,callback,sync){var func=expression,me=this;if(expression){if(Array.isArray(expression))return function(cb){expression.forEach(function(expr){me.$watch(expr,cb)})}(callback);"string"==typeof expression&&(func=function(){return this.$eval(expression)});var wid=++watchId;return this._$$watched.push({watchId:wid,scopeId:this._$id,value:sync?this.$eval(expression):null,expression:expression+"",func:function(){return func.call(me)},callback:callback||noop}),this._$digestAsync(),function(){me._$$watched=me._$$watched.filter(function(w){return w.watchId!==wid})}}}},module.exports=Scope},{"./clone":1,"./each":2,"./ng-parse":4}],6:[function(require,module,exports){function Validator(){this._validations=[],this._status={}}Validator.prototype={constructor:Validator,register:function(group,fn){"function"==typeof group&&(fn=group),this._validations.push({group:group,validateFn:fn});var me=this;return function(){me.unregister(group,fn)}},unregister:function(group,fn){this._validations=this._validations.filter(function(tuple){return!(tuple.group===group&&tuple.validateFn===fn)})},validate:function(fn){var me=this;return this._validations.filter(fn||Boolean).every(function(tuple){var res=tuple.validateFn();return res="object"==typeof res?res:{value:res},me._status={group:tuple.group,value:res.value,msg:res.msg},me._status.value})},getStatus:function(){return this._status}};var instances=[];Validator.getInstance=function(form){var node=form._node||form.element||form;if(!node)throw new Error("please pass a [form instance] or [string] to validator.getInstance..");var filtered=instances.filter(function(tuple){return tuple.node===node});if(filtered[0])return filtered[0].instance;var instance=new Validator;return instances.push({node:node,instance:instance}),instance},Validator._instances=instances,module.exports=Validator},{}]},{},[3]);
